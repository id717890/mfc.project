<span defaultOverlayTarget></span>
<div class="container-fluid custom-modal-container">
	<div class="row custom-modal-header">
		<div class="col-sm-12">
			<h3>{{context.title}}</h3>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12">
			<form id="package-editor" class="form" role="form" [ngBusy]="{busy: busy, message:busyMessage}" style="position: relative"
				#packageForm="ngForm">
				<div class="form-group">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
							<button id="button-apply" class="btn btn-success" (click)="dialog.close(context.model)" [disabled]="context.model.files==0"
								style="width:100%">Сохранить</button>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
							<button id="button-cancel" class="btn btn-primary" (click)="dialog.dismiss()" style="width:100%">Отменить</button>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>Дата</label>
							<my-date-picker [options]="myDatePickerOptions" (dateChanged)="onChangeDate($event)" [selDate]="currentDate"></my-date-picker>
						</div>
					</div>
					<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>ОГВ</label>
							<select name="organization" class="form-control" [(ngModel)]="context.model.organization">
						        <option *ngFor="let organization of organizations" [ngValue]="organization">{{organization.caption}}</option>
					        </select>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label>Описание</label>
							<input class="form-control" name="comment" [(ngModel)]="context.model.comment" #comment="ngModel">
						</div>
					</div>
				</div>
				<div class="row" *ngIf="context.model.files!=null">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="panel panel-default">
							<table class="table table-striped table-hover table-responsive table-condensed">
								<colgroup>
									<col>
									<col>
									<col>
									<col>
									<col>
									<col>
									<col>
									<col class="col-width-50" *ngIf="context.model.id!=null">
								</colgroup>
								<thead>
									<tr>
										<th>Дата</th>
										<th>ОГВ</th>
										<th>Услуга</th>
										<th>Эксперт</th>
										<th>Контролёр</th>
										<th>Описание</th>
										<th>Статус</th>
										<th *ngIf="context.model.id!=null"></th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor="let file of context.model.files ">
										<td title="{{file.date | date: 'dd.MM.yyyy HH:mm'}}">{{file.date | date: 'dd.MM.yy'}}</td>
										<td>{{file.organization?.caption}}</td>
										<td>{{file.action?.service?.caption}}</td>
										<td>{{file.expert?.user_name}}</td>
										<td>{{file.controller?.user_name}}</td>
										<td>{{file.caption}}</td>
										<td>{{file.status?.caption}}</td>
										<td *ngIf="context.model.id!=null">
											<a (click)="editActionOfPackage(file.action, file)" class="glyphicon glyphicon-edit" title="Редактировать дело"></a>
											<a (click)="deleteFileOfPackage(file)" class="glyphicon glyphicon-remove" title="Удалить запись"></a>
										</td>
									</tr>
									<tr *ngIf="context.model.files==0">
										<td colspan="8" style="text-align:center; padding: 5px">Данный пакет не содержит дела</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>